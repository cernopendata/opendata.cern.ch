{%- extends "cernopendata_records_ui/records/detail.html" %}


{%- block page_body %}
<div class="container">
  <div class="row">
    <div class="col-md-10">
      <div class="panel panel-default">
        <div class="panel-heading">
          {% block heading %}
            {{super()}}
          {% endblock heading %}
        </div>
        <div class="panel-body">
          {% block metadata_block %}
          {{ super() }}
          {% if record.get('relations', []) %}
          <div class="row">
            <div class="col-md-12">
              <h3>Related Datasets</h3>
              {% for relation in record.relations %}
              <p>{{relation.get('description', '')}} <br><a href="/datasets/{{relation.get('recid', '')}}">{{relation.get('recid', '')}}</a></p>
              {% endfor %}
            </div>
          </div>
          {% endif %}
          {% if record.get('distribution', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>Characteristics</h3>
              <label>Dataset:</label>
              <span><strong>{{record.get('distribution', {}).get('number_events', '')}}</strong> events</span>
              <span><strong>{{record.get('distribution', {}).get('number_files', '')}}</strong> files</span>
              <span><strong>{{record.get('distribution', {}).get('size', '') | filesizeformat }}</strong> in total</span>
            </div>
          </div>
          {% endif %}
          {% if record.get('system_details', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>System Details</h3>
              <label>Global tag:</label>
              <span>{{record.get('system_details', {}).get('global_tag', '')}}</span>
              <br>
              <label>{{record.get('system_details', {}).get('description', '')}}:</label>
              <span>{{record.get('system_details', {}).get('release', '')}}</span>
            </div>
          </div>
          {% endif %}
          {% endblock metadata_block %}

          {% block files_block %} {{ super() }} {% endblock files_block %}

          {% if record.get('dataset_semantics', []) %}
          <div class="row">
            <div class="col-md-12">
              <h3>Dataset Semantics</h3>
              {% for semantic in record.dataset_semantics %}
              <label>{{semantic.get('variable', '')}}:</label>
              <span>{{semantic.get('description', '')}}</span><br>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          {% if record.get('selection', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>How were these data selected</h3>
              <p>{{ record.get('selection', {}).get('description', '') }}</p>
            </div>
          </div>
          {% endif %}

          {% if record.get('generation', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>How were these data selected?</h3>
              <p>{{record.get('generation', {}).get('description', '')}}</p>
              {% for step in record.get('generation', {}).get('steps', []) %}
              <label>{{step.get('type', '')}}</label>
              <p>{{step.get('note', '')}}</p>
              <p>{{step.get('release', '')}}</p>
              <p>{{step.get('global_tag', '')}}</p>
              {% for conf_file in step.get('configuration_files', []) %}
              <p><a href="/records/{{conf_file.get('recid', '')}}">{{conf_file.get('description', '')}}</a></p>
              <p><a href="/search?q={{conf_file.get('title', '')}}">{{conf_file.get('title', '')}}</a></p>
              {% endfor %}
              {% endfor %}
            </div>
          </div>
          {% endif %}
          {% if record.get('validation', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>How were these data validated?</h3>
              <p>{{record.get('validation', {}).get('description', '')}}</p>
              {% for link in record.get('validation', {}).get('links', []) %}
              <p><a href="{{link.get('url', '')}}">{{link.get('description', '')}}</a></p>
              {% endfor %}
            </div>
          </div>
          {% endif %}
          {% if record.get('usage', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>How can you use these data?</h3>
              <p>{{record.get('usage', {}).get('description', '')}}</p>
              {% for link in record.get('usage', {}).get('links', []) %}
              <p><a href="{{link.get('url', '')}}">{{link.get('description', '')}}</a></p>
              {% endfor %}
            </div>
          </div>
          {% endif %}
          {% if record.get('note', {}) %}
          <div class="row">
            <div class="col-md-12">
              <h3>Issues & Limitations</h3>
              <p>{{record.get('note', {}).get('description', '')}}</p>
              {% for link in record.note.links %}
              <p><a href="/record/{{link.get('recid', '')}}">{{link.get('recid', '')}}</a></p>
              {% endfor %}
            </div>
          </div>
          {% endif %}
          {% block disclaimer %}
          {{super()}}
          {% endblock disclaimer %}
        </div>
      </div>
    </div>
    {% block export %}
    <div class="col-md-2">
      <div class="well">
        <h4> Export </h4>
        <ul class="list-inline">
          <li><a
            href="{{ url_for('invenio_records_ui.datid_export', pid_value=pid.pid_value, format='json') }}">JSON</a>
          </li>
        </ul>
      </div>
    </div>
    {% endblock export %}
  </div>
</div>
{%- endblock %}

